<!DOCTYPE html>
      <html lang="en">
        <head>
          <meta charset="utf-8" />
          <meta
            name="viewport"
            content="width=device-width, initial-scale=1, shrink-to-fit=no"
          />
          <link
            rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
            integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l"
            crossorigin="anonymous"
          />
          <title>Previsualización de PDF</title>
        </head>
      
        <body style="font-size: 15px; font-family: Arial">
          <style>
            html { -webkit-print-color-adjust: exact; }
            .block-height{
                height: 30px;
            }

            .text-aling-top-center{
                vertical-align: text-top !important;
                text-align: center !important;
            }
            .text-aling-top-left{
                vertical-align: text-top !important;
                text-align: left !important;
            }
            .bg-info{
                background: #83b3f2 !important;
            }
            .encabezado {
              margin-top: 20px;
              display: flex;
              justify-content: space-between;
            }
      
            .cuerpo {
              margin-top: -18px;
              display: flex;
              justify-content: space-between;
            }
      
            .complete {
              width: 60%;
            }
      
            table {
              font-family: arial, sans-serif;
              border-collapse: collapse;
              width: 100%;
            }
      
            td,
            th {
              border: 1px solid #dddddd;
              text-align: left;
            }
      
            .date {
              width: 4%;
            }
      
            .divisor {
              padding-top: 5px;
              padding-bottom: 5px;
            }
            table,
            th,
            td {
              border: 2px solid black;
            }
            .topheader{
              padding-top:50px
            }
          </style>
          
          <div class="container">
            <div class="row">
                <div class="col-3 offset-2">
                    <br>
                    <br>
                    <br>
                    <br>
                    <br>
                    <p class="text-center">
                        <img
                        src="/static/img/logoi.png"
                        alt=""
                        style="width: 250px; display:block; margin:auto;"
                        class="img-fluid float-right"
                    />
                    </p>
                </div>
                <div class="col-3">
                    <br>
                    <br>
                    <br>
                    <p class="text-center">
                        <img
                        src="/static/img/logo.png"
                        alt=""
                        style="width: 250px; display:block; margin:auto;"
                        class="img-fluid float-right"
                    />
                    </p>
                </div>
                <div class="col-3">
                    <br>
                    <br>
                    <br>
                    <p class="text-center">
                        <img
                        src="/static/img/logoec.png"
                        alt=""
                        style="width: 250px; display:block; margin:auto;"
                        class="img-fluid float-right"
                    />
                    </p>
                </div>
            </div>
          </div>
          <div class="container-fluid topheader">
            <div class="text-center">
              <h5><b>INSTITUTO SALVADOREÑO DE FORMACIÓN PROFESIONAL</b></h5>
              <P>GERENCIA DE FORMACIÓN INICIAL, PROGRAMA EMPRESA-CENTRO</P>
            </div>
            <div class="container ">
                <div class="row">
                    <div class="col-12 bg-info block-height">
                        <h6 class=" text-aling-top-center"><b>
                             INFORME DE ATENCIÓN PSICOLOGICA
                        </b></h6>
                    </div>
                </div>
            </div>
            <br>
            <div class="container ">
              <div class="row">
                  <div class="col-12 block-height bg-info" >
                      <h6 class=" text-aling-top-left">
                          I. IDENTIFICACIÓN:
                      </h6>
                  </div>
              </div>
          </div>
          <br><br>
            <div class="container">
                <dic class="row">
                    <div class="col-12">
                        <table class="table-sm">
                            <thead>
                              <tr>
                                <th width='20%'>Nombre:</th>
                                <th><input type="text" id="name" name="name" value="<%= datos.nombres%> <%= datos.apellidos%>" class="form-control"></th>
                              </tr>
                            </thead>
                            <tbody>
                              <tr>
                                  <td>Edad</td>
                                  <td><input type="text" id="yearOld" name="yearOld" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Fecha Nacimiento</td>
                                  <td><input type="text" id="date" name="date" value="<%= datos.fechaNac%>" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Estado civil</td>
                                  <td><input type="text" id="state" name="state" value="<%= datos.estado_civil%>" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Escolaridad</td>
                                  <td><input type="text" id="scholarship" name="scholarship" value="<%= datos.nivel_academico%>" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Domicilio</td>
                                  <td><input type="text" id="address" name="address" value="<%= datos.direccion%>" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Personas con quienes vive</td>
                                  <td><input type="text" id="persons" name="persons" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Número telefónico/:</td>
                                  <td><input type="text" id="tel" name="tel" value="<%= datos.telefono_movil%>" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Programa</td>
                                  <td>Empresa Centro</td>
                              </tr>
                              <tr>
                                  <td>Personas responsable: </td>
                                  <td><input type="text" id="responsable_person" value="" name="responsable_person" class="form-control"></td>
                              </tr>
                              <tr>
                                  <td>Fecha de referencia:</td>
                                  <td><input type="text" id="refer_date" name="refer_date" class="form-control"></td>
                              </tr>
                            </tbody>
                        </table>
                    </div>
                </dic>    
            </div>
            <br><br>
            <div class="container ">
                <div class="row">
                    <div class="col-12 bg-info block-height">
                        <h6 class=" text-aling-top-left">
                             II. MOTIVO DE ATENCIÓN:
                        </h6>
                    </div>
                    <div class="col-12">
                        <br>
                        <textarea class="form-control" id="reason" rows="3"><% dataReason.forEach( (element)=> { %> <%= element.nombre %> ,<% });%></textarea>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="container ">
                <div class="row">
                    <div class="col-12 block-height bg-info" >
                        <h6 class=" text-aling-top-left">
                             III. DESCRIPCIÓN DEL CASO:
                        </h6>
                    </div>
                    <div class="col-12">
                        <br>
                        <textarea class="form-control" id="description"  rows="3"><%= datosPsychology.observaciones%></textarea>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="container ">
                <div class="row">
                    <div class="col-12 bg-info block-height">
                        <h6 class=" text-aling-top-left">
                             IV. ABORDAJE:
                        </h6>
                    </div>
                    <div class="col-12">
                        <br>
                        
                        <textarea class="form-control" id="approach" rows="3"><%  dataStrategies.forEach( (element)=> { %> <%= element.nombre %> ,<% });%></textarea>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="container ">
                <div class="row">
                    <div class="col-12 bg-info block-height">
                        <h6 class=" text-aling-top-left">
                             V. RECOMENDACIONES
                        </h6>
                    </div>
                    <div class="col-12">
                        <br>
                        <textarea class="form-control" id="recommendations" rows="3"></textarea>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="container ">
                <div class="row">
                    <div class="col-12 bg-info block-height">
                        <h6 class=" text-aling-top-left">
                             VI. SEGUIMIENTO
                        </h6>
                    </div>
                    <div class="col-12">
                        <br>
                        <textarea class="form-control" id="follow_up" rows="3"><%= datosPsychology.next_date%></textarea>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="container">
              <div class="row align-items-center">
                <div class="col-12">
                    <p class="text-center"><b><input type="text" id="nowDate" class="form-control" placeholder="Introduzca una fecha ejemplo San Salvador, 17 de septiembre de 2019"></b></p>
                </div>
                <div class="col-12">
                    <p class="text-center">
                        <label class="text-center">F.________________________ 
                            <br/><b><input type="text" id="namePsychology" name="namePsychology" class="form-control"></b> <br />
                        Licenciada en psicología</label>
                    </p>
                </div>
                <div class="col-6 offset-3">
                    <button class="btn btn-success btn-block btn-lg" id="btnPDF">Crear Reporte</button>
                </div>
              </div>
              <br />
            </div>
            
          </div>
        </body>
      </html>               
<script src="https://cdn.jsdelivr.net/npm/dayjs@1.10.6/dayjs.min.js"></script>
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
<%if(type != 0){%>
    <script>
        $("#name").val('<%= datosReport.name%>') 
        $("#yearOld").val('<%= datosReport.yearOld%>') 
        $("#date").val('<%= datosReport.date%>') 
        $("#state").val('<%= datosReport.state%>') 
        $("#scholarship").val('<%= datosReport.scholarship%>') 
        $("#address").val('<%= datosReport.address%>') 
        $("#persons").val('<%= datosReport.persons%>') 
        $("#tel").val('<%= datosReport.tel%>') 
        $("#responsable_person").val('<%= datosReport.responsable_person%>') 
        $("#refer_date").val('<%= datosReport.refer_date%>') 
        $("#reason").val('<%= datosReport.reason%>') 
        $("#description").val('<%= datosReport.description%>') 
        $("#approach").val('<%= datosReport.approach%>') 
        $("#recommendations").val('<%= datosReport.recommendations%>') 
        $("#follow_up").val('<%= datosReport.follow_up%>') 
        $("#nowDate").val('<%= datosReport.nowDate%>');
        $("#namePsychology").val('<%= datosReport.namePsychology%>');
    </script>
<%}%>
<script src="/static/js/psychology/pdf/psychology_pdf.js"></script>
<script>
    const calculateAge = (fecha) =>{
    const date1 = dayjs(fecha);
    const date2 = dayjs(DateNow());
    return date2.diff(date1, 'year');
};

const DateNow = () =>{
    let date = new Date();
    let day = date.getDate();
    let month = date.getMonth() + 1;
    let year = date.getFullYear();
    if(month < 10){
      return `${year}-0${month}-${day}`;
    }else{
      return `${year}-${month}-${day}`;
    }
};
$(document).ready(function(){
    $('#yearOld').val(calculateAge('<%= datos.fechaNac%>'));
    fechaSeguimiento();
    firma();
});
$("#btnPDF").click(function(){
    printPdfPsychology('<%= idPsychology%>');
});
const modelHour = (date) =>{
    const fullDate = new Date(date);
    if(fullDate.getHours() >=18 || fullDate.getHours()<=6){
        fullDate.setDate(fullDate.getDate());
    }
    fullDate.setHours(fullDate.getHours() +6);
    let hour = fullDate.getHours();
    let minutes = fullDate.getMinutes();
    if(hour<10){
        hour = '0'+hour;
    }
    if(minutes<10){
        minutes = '0'+minutes;
    }
    const hourReturn = hour+':'+minutes+':00';
    return hourReturn;
};
const fechaSeguimiento = () =>{
    if($("#follow_up").val() != ''){
        const fullDate = new Date($("#follow_up").val());
        if(fullDate.getHours() >=18 || fullDate.getHours()<=6){
            fullDate.setDate(fullDate.getDate());
        }
        fullDate.setHours(fullDate.getHours() +6);
        $("#follow_up").val('Seguimiento asignado la fecha '+fullDate.toLocaleDateString() + ' a la hora '+ modelHour($("#follow_up").val()));
    }else{  
        $("#follow_up").val('');
    }
};
const firma = ()=>{
    $("#namePsychology").val('Flor Lisseth Clímaco de Palomo')
};
</script>